{
  "version": 3,
  "sources": ["../src/js/media-thumbnail-preview.js"],
  "sourcesContent": ["/*\n  <media-thumbnail-preview media=\"#myVideo\" time=\"10.00\">\n\n  Uses the \"thumbnails\" track of a video element to show an image relative to\n  the video time given in the `time` attribute.\n*/\nimport {\n  Window as window,\n  Document as document,\n} from './utils/server-safe-globals.js';\nimport { defineCustomElement } from './utils/defineCustomElement.js';\nimport { MediaUIAttributes } from './constants.js';\n\nconst template = document.createElement('template');\n\ntemplate.innerHTML = `\n  <style>\n    :host {\n      background-color: #000;\n      height: auto;\n      width: auto;\n    }\n\n    img {\n      object-fit: none;\n    }\n  </style>\n  <img crossorigin loading=\"eager\" decoding=\"async\" />\n`;\n\nclass MediaThumbnailPreviewElement extends window.HTMLElement {\n  static get observedAttributes() {\n    return [\n      MediaUIAttributes.MEDIA_CONTROLLER,\n      'time',\n      MediaUIAttributes.MEDIA_PREVIEW_IMAGE,\n      MediaUIAttributes.MEDIA_PREVIEW_COORDS,\n    ];\n  }\n\n  constructor() {\n    super();\n\n    this.attachShadow({ mode: 'open' });\n    this.shadowRoot.appendChild(template.content.cloneNode(true));\n  }\n\n  connectedCallback() {\n    const mediaControllerId = this.getAttribute(\n      MediaUIAttributes.MEDIA_CONTROLLER\n    );\n    if (mediaControllerId) {\n      const mediaControllerEl = document.getElementById(mediaControllerId);\n      mediaControllerEl?.associateElement?.(this);\n    }\n  }\n\n  disconnectedCallback() {\n    const mediaControllerSelector = this.getAttribute(\n      MediaUIAttributes.MEDIA_CONTROLLER\n    );\n    if (mediaControllerSelector) {\n      const mediaControllerEl = document.getElementById(mediaControllerId);\n      mediaControllerEl?.unassociateElement?.(this);\n    }\n  }\n\n  attributeChangedCallback(attrName, oldValue, newValue) {\n    if (\n      [\n        'time',\n        MediaUIAttributes.MEDIA_PREVIEW_IMAGE,\n        MediaUIAttributes.MEDIA_PREVIEW_COORDS,\n      ].includes(attrName)\n    ) {\n      this.update();\n    }\n    if (attrName === MediaUIAttributes.MEDIA_CONTROLLER) {\n      if (oldValue) {\n        const mediaControllerEl = document.getElementById(oldValue);\n        mediaControllerEl?.unassociateElement?.(this);\n      }\n      if (newValue) {\n        const mediaControllerEl = document.getElementById(newValue);\n        mediaControllerEl?.associateElement?.(this);\n      }\n    }\n  }\n\n  update() {\n    const mediaPreviewCoordsStr = this.getAttribute(\n      MediaUIAttributes.MEDIA_PREVIEW_COORDS\n    );\n    const mediaPreviewImage = this.getAttribute(\n      MediaUIAttributes.MEDIA_PREVIEW_IMAGE\n    );\n    if (!(mediaPreviewCoordsStr && mediaPreviewImage)) return;\n    const img = this.shadowRoot.querySelector('img');\n    const [x, y, w, h] = mediaPreviewCoordsStr\n      .split(/\\s+/)\n      .map((coord) => +coord);\n    const src = mediaPreviewImage;\n\n    const resize = () => {\n      img.style.height = `${h}px`;\n      img.style['aspect-ratio'] = `${w} / ${h}`;\n    };\n\n    if (img.src !== src) {\n      img.onload = resize;\n      img.src = src;\n      resize();\n    }\n\n    resize();\n    img.style['object-position'] = `-${x}px -${y}px`\n  }\n}\n\ndefineCustomElement('media-thumbnail-preview', MediaThumbnailPreviewElement);\n\nexport default MediaThumbnailPreviewElement;\n"],
  "mappings": "AAMA,sEAIA,qEACA,mDAEA,KAAM,GAAW,EAAS,cAAc,YAExC,EAAS,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAerB,eAA2C,GAAO,WAAY,WACjD,qBAAqB,CAC9B,MAAO,CACL,EAAkB,iBAClB,OACA,EAAkB,oBAClB,EAAkB,sBAItB,aAAc,CACZ,QAEA,KAAK,aAAa,CAAE,KAAM,SAC1B,KAAK,WAAW,YAAY,EAAS,QAAQ,UAAU,KAGzD,mBAAoB,CA/CtB,MAgDI,KAAM,GAAoB,KAAK,aAC7B,EAAkB,kBAEpB,GAAI,EAAmB,CACrB,KAAM,GAAoB,EAAS,eAAe,GAClD,oBAAmB,mBAAnB,eAAsC,OAI1C,sBAAuB,CAzDzB,MA6DI,GAHgC,KAAK,aACnC,EAAkB,kBAES,CAC3B,KAAM,GAAoB,EAAS,eAAe,mBAClD,oBAAmB,qBAAnB,eAAwC,OAI5C,yBAAyB,EAAU,EAAU,EAAU,CAnEzD,QA6EI,GARE,CACE,OACA,EAAkB,oBAClB,EAAkB,sBAClB,SAAS,IAEX,KAAK,SAEH,IAAa,EAAkB,iBAAkB,CACnD,GAAI,EAAU,CACZ,KAAM,GAAoB,EAAS,eAAe,GAClD,oBAAmB,qBAAnB,eAAwC,MAE1C,GAAI,EAAU,CACZ,KAAM,GAAoB,EAAS,eAAe,GAClD,oBAAmB,mBAAnB,eAAsC,QAK5C,QAAS,CACP,KAAM,GAAwB,KAAK,aACjC,EAAkB,sBAEd,EAAoB,KAAK,aAC7B,EAAkB,qBAEpB,GAAI,CAAE,IAAyB,GAAoB,OACnD,KAAM,GAAM,KAAK,WAAW,cAAc,OACpC,CAAC,EAAG,EAAG,EAAG,GAAK,EAClB,MAAM,OACN,IAAI,AAAC,GAAU,CAAC,GACb,EAAM,EAEN,EAAS,IAAM,CACnB,EAAI,MAAM,OAAS,GAAG,MACtB,EAAI,MAAM,gBAAkB,GAAG,OAAO,KAGxC,AAAI,EAAI,MAAQ,GACd,GAAI,OAAS,EACb,EAAI,IAAM,EACV,KAGF,IACA,EAAI,MAAM,mBAAqB,IAAI,QAAQ,OAI/C,EAAoB,0BAA2B,GAE/C,GAAO,GAAQ",
  "names": []
}
